<img width="1127" height="665" alt="image" src="https://github.com/user-attachments/assets/6e9a1d4c-4b8b-482b-b676-9d0a820ddca2" />


# DND 跑团管理器

一个现代化的 DND 跑团资料管理工具，提供直观的界面和完整的跑团管理功能。

---

## 📖 用户使用指南

### 🎯 快速开始

1. **安装依赖**
   ```bash
   pip install pillow
   ```

2. **启动程序**
   ```bash
   python main.py
   ```

3. **创建第一个跑团**
   - 点击左侧"新建跑团"按钮
   - 输入跑团名称
   - 程序会自动创建跑团文件夹结构

### 🎲 跑团管理

#### 创建和管理跑团
- **新建跑团**：点击"新建跑团"按钮，输入跑团名称
- **切换跑团**：在左侧列表中点击选择不同的跑团
- **删除跑团**：选中跑团后点击"删除跑团"按钮（会删除整个跑团文件夹）

#### 跑团数据结构
每个跑团包含四个固定分类：
- **人物卡（characters）**：存储玩家角色信息
- **怪物卡（monsters）**：存储NPC和怪物数据
- **地图（maps）**：存储地图图片文件
- **剧情（notes）**：存储剧情笔记和故事线

### 📝 内容管理

#### 文本内容（人物卡/怪物卡/剧情）

**创建文件**
1. 选择对应分类（人物卡/怪物卡/剧情）
2. 点击"新建文件"按钮
3. 输入文件名（无需扩展名，程序自动添加.txt）
4. 程序会根据分类自动生成模板内容

**查看和编辑**
- 在文件列表中单击文件可在右侧预览内容
- 双击文件使用系统默认编辑器打开进行编辑
- 内容会实时从磁盘重新读取，确保显示最新版本

**文件模板**
- **人物卡模板**：包含姓名、种族、职业、技能、装备、背景等字段
- **怪物卡模板**：包含姓名、CR、属性、攻击、特性等字段
- **剧情文件**：空白文件，可自由编写

#### 地图管理

**导入地图**
1. 选择"地图"分类
2. 点击"导入文件"按钮
3. 选择一个或多个图片文件
4. 文件会被复制到跑团的地图文件夹中

**查看地图**
- 在文件列表中单击地图文件可在右侧预览
- 图片会自动缩放以适应显示区域，保持原始比例
- 双击地图文件使用系统默认图片查看器打开原图

#### 剧情文件夹管理

剧情分类支持子文件夹功能：
- **进入文件夹**：双击标有"[DIR]"的文件夹项
- **返回上级**：点击"返回上级"按钮（仅在子文件夹中显示）
- **文件夹优先**：文件夹始终显示在文件列表顶部

### 🗑️ 安全删除功能

程序提供安全的删除功能：
- 点击"删除文件"按钮可删除选中的文件或文件夹
- **重要**：删除操作仅从软件界面隐藏文件，不会真正删除磁盘上的文件
- 被隐藏的文件信息保存在跑团目录的`.hidden_files`文件中
- 如需恢复文件，可直接编辑该隐藏文件列表或重新导入

### 🎨 界面特性

- **现代化UI**：采用统一的颜色方案和字体系统
- **响应式布局**：基于8px网格系统的精确间距
- **交互反馈**：按钮悬停效果、焦点指示器等
- **分类状态**：当前选中的分类按钮有明显的激活状态
- **内容预览**：右侧实时显示选中文件的内容

### 💡 使用技巧

1. **文件命名**：避免使用特殊字符 `/\:*?"<>|`
2. **图片格式**：支持常见格式（PNG、JPG、GIF等）
3. **文本编码**：所有文本文件使用UTF-8编码，支持中文
4. **快捷操作**：
   - 双击文件快速打开编辑
   - 使用Tab键在界面元素间切换
   - 对话框中按Enter确认，Esc取消

---

## 🔧 开发者指南

### 📁 项目架构

```
dnd_manager/
├── main.py                    # 主程序入口和核心逻辑
├── theme_system.py           # 主题系统（颜色、字体、间距）
├── theme_integration.py      # 主题集成和对话框
├── theme_utils.py           # 主题工具函数和交互反馈
├── layout_system.py         # 布局系统和响应式设计
├── visual_enhancements.py   # 视觉增强功能
├── final_integration_simple.py # 最终集成和测试
├── README.md                # 项目文档
├── CHANGELOG_beta_0.2.md    # 版本更新日志
└── data/                    # 数据目录（运行时创建）
    └── campaigns/           # 跑团数据
        └── [跑团名]/
            ├── characters/  # 人物卡目录
            ├── monsters/    # 怪物卡目录
            ├── maps/        # 地图目录
            ├── notes/       # 剧情目录
            └── .hidden_files # 隐藏文件列表
```

### 🏗️ 核心组件

#### 主题系统 (theme_system.py)
- **ColorPalette**: 统一的颜色方案，符合WCAG可访问性标准
- **Typography**: 字体系统，基于8pt网格
- **Spacing**: 间距系统，基于8px网格
- **ThemeConfig**: 主题配置管理
- **ThemeManager**: 全局主题管理器

#### 布局系统 (layout_system.py)
- **LayoutConfig**: 基于8px网格的布局配置
- **LayoutManager**: 布局管理和响应式设计
- 支持不同屏幕尺寸的自适应布局

#### 主题集成 (theme_integration.py)
- **ThemeIntegrator**: 将主题系统集成到现有应用
- **现代化对话框**: 替代标准messagebox的主题化对话框
- **动态主题应用**: 支持运行时主题切换

#### 交互增强 (theme_utils.py)
- 按钮悬停效果和点击反馈
- 列表选择和悬停效果
- 分类按钮状态管理
- 焦点指示器和键盘导航

### 🔧 开发环境设置

1. **Python环境**
   ```bash
   python --version  # 需要Python 3.6+
   ```

2. **安装依赖**
   ```bash
   pip install pillow  # 图片处理
   # Tkinter是Python标准库，无需额外安装
   ```

3. **运行开发版本**
   ```bash
   python main.py  # 启动主程序
   python final_integration_simple.py  # 运行集成测试
   ```

### 🧪 测试和验证

#### 功能测试
```bash
# 运行集成验证测试
python final_integration_simple.py
```

#### 手动测试检查项
- [ ] 跑团创建和删除功能
- [ ] 四个分类的切换和文件管理
- [ ] 文本文件的创建、预览和编辑
- [ ] 图片文件的导入和预览
- [ ] 剧情文件夹的导航功能
- [ ] 安全删除和隐藏功能
- [ ] 界面响应式调整
- [ ] 主题和交互效果



#### 主题应用流程
1. **初始化**: 创建ThemeManager和LayoutManager实例
2. **UI构建**: 在build_ui()中应用主题样式
3. **集成**: 通过ThemeIntegrator整合所有主题功能
4. **增强**: 添加交互反馈和视觉效果

#### 文件操作流程
1. **创建**: 根据分类生成模板文件
2. **读取**: 实时从磁盘读取文件内容
3. **预览**: 在右侧面板显示内容
4. **编辑**: 调用系统默认编辑器
5. **删除**: 添加到隐藏列表而非物理删除








