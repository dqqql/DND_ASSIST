<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒ‰é’®åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { background: #f8f9fa; padding: 20px; margin: 10px 0; border-radius: 8px; }
        .btn { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
        .btn:hover { background: #0056b3; }
        .btn:active { background: #004085; }
        .result { background: white; border: 1px solid #dee2e6; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { background: #d4edda; border-color: #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border-color: #f5c6cb; color: #721c24; }
    </style>
</head>
<body>
    <h1>ğŸ”˜ æŒ‰é’®åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>åŸºç¡€æŒ‰é’®æµ‹è¯•</h2>
        <button class="btn" onclick="testBasicClick()">åŸºç¡€ç‚¹å‡»æµ‹è¯•</button>
        <button class="btn" onclick="testAPICall()">APIè°ƒç”¨æµ‹è¯•</button>
        <button class="btn" onclick="testModalDialog()">æ¨¡æ€å¯¹è¯æ¡†æµ‹è¯•</button>
        <div id="basicResult" class="result">ç­‰å¾…æµ‹è¯•...</div>
    </div>

    <div class="test-section">
        <h2>ä¸»ç•Œé¢æŒ‰é’®æ¨¡æ‹Ÿ</h2>
        <button class="btn" id="mockRefreshBtn">åˆ·æ–°æŒ‰é’®</button>
        <button class="btn" id="mockCreateBtn">åˆ›å»ºè·‘å›¢</button>
        <button class="btn" id="mockHelpBtn">å¸®åŠ©æŒ‰é’®</button>
        <div id="mockResult" class="result">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æµ‹è¯•...</div>
    </div>

    <div class="test-section">
        <h2>äº‹ä»¶ç»‘å®šæµ‹è¯•</h2>
        <button class="btn" onclick="testEventBinding()">æµ‹è¯•äº‹ä»¶ç»‘å®š</button>
        <div id="eventResult" class="result">ç­‰å¾…æµ‹è¯•...</div>
    </div>

    <script>
        // è¿‡æ»¤æ‰©å±•ç¨‹åºé”™è¯¯
        window.onerror = function(message, source, lineno, colno, error) {
            if (message && message.includes('runtime.lastError')) {
                return true; // å¿½ç•¥æ‰©å±•ç¨‹åºé”™è¯¯
            }
            console.error('çœŸå®é”™è¯¯:', message);
            return false;
        };

        function testBasicClick() {
            const result = document.getElementById('basicResult');
            result.innerHTML = 'âœ… åŸºç¡€ç‚¹å‡»åŠŸèƒ½æ­£å¸¸ï¼æ—¶é—´ï¼š' + new Date().toLocaleString();
            result.className = 'result success';
            console.log('åŸºç¡€ç‚¹å‡»æµ‹è¯•é€šè¿‡');
        }

        async function testAPICall() {
            const result = document.getElementById('basicResult');
            result.innerHTML = 'æ­£åœ¨æµ‹è¯•APIè°ƒç”¨...';
            result.className = 'result';
            
            try {
                const response = await fetch('/api/campaigns');
                if (response.ok) {
                    const data = await response.json();
                    result.innerHTML = `âœ… APIè°ƒç”¨æˆåŠŸï¼<br>æ•°æ®ï¼š${JSON.stringify(data, null, 2)}`;
                    result.className = 'result success';
                    console.log('APIè°ƒç”¨æµ‹è¯•é€šè¿‡', data);
                } else {
                    result.innerHTML = `âŒ APIè°ƒç”¨å¤±è´¥ï¼š${response.status}`;
                    result.className = 'result error';
                }
            } catch (error) {
                result.innerHTML = `âŒ APIè°ƒç”¨å¼‚å¸¸ï¼š${error.message}`;
                result.className = 'result error';
                console.error('APIè°ƒç”¨æµ‹è¯•å¤±è´¥', error);
            }
        }

        function testModalDialog() {
            const result = document.getElementById('basicResult');
            
            // åˆ›å»ºç®€å•çš„æ¨¡æ€å¯¹è¯æ¡†
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
            `;
            
            const content = document.createElement('div');
            content.style.cssText = `
                background: white;
                padding: 20px;
                border-radius: 8px;
                text-align: center;
            `;
            content.innerHTML = `
                <h3>æµ‹è¯•æ¨¡æ€å¯¹è¯æ¡†</h3>
                <p>è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å¯¹è¯æ¡†</p>
                <button class="btn" onclick="this.closest('[style*=fixed]').remove()">å…³é—­</button>
            `;
            
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            result.innerHTML = 'âœ… æ¨¡æ€å¯¹è¯æ¡†åˆ›å»ºæˆåŠŸï¼';
            result.className = 'result success';
            console.log('æ¨¡æ€å¯¹è¯æ¡†æµ‹è¯•é€šè¿‡');
        }

        function testEventBinding() {
            const result = document.getElementById('eventResult');
            result.innerHTML = 'æ­£åœ¨æµ‹è¯•äº‹ä»¶ç»‘å®š...';
            
            try {
                // æµ‹è¯•addEventListener
                const testBtn = document.createElement('button');
                testBtn.textContent = 'ä¸´æ—¶æµ‹è¯•æŒ‰é’®';
                testBtn.className = 'btn';
                
                let eventFired = false;
                testBtn.addEventListener('click', function() {
                    eventFired = true;
                    console.log('äº‹ä»¶ç›‘å¬å™¨è§¦å‘');
                });
                
                // æ·»åŠ åˆ°é¡µé¢å¹¶è§¦å‘ç‚¹å‡»
                document.body.appendChild(testBtn);
                testBtn.click();
                
                // æ£€æŸ¥ç»“æœ
                if (eventFired) {
                    result.innerHTML = 'âœ… äº‹ä»¶ç»‘å®šæ­£å¸¸å·¥ä½œï¼';
                    result.className = 'result success';
                    console.log('äº‹ä»¶ç»‘å®šæµ‹è¯•é€šè¿‡');
                } else {
                    result.innerHTML = 'âŒ äº‹ä»¶ç»‘å®šå¤±è´¥ï¼';
                    result.className = 'result error';
                }
                
                // æ¸…ç†
                testBtn.remove();
                
            } catch (error) {
                result.innerHTML = `âŒ äº‹ä»¶ç»‘å®šæµ‹è¯•å¼‚å¸¸ï¼š${error.message}`;
                result.className = 'result error';
                console.error('äº‹ä»¶ç»‘å®šæµ‹è¯•å¤±è´¥', error);
            }
        }

        // æ¨¡æ‹Ÿä¸»ç•Œé¢æŒ‰é’®çš„äº‹ä»¶ç»‘å®š
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œç»‘å®šæ¨¡æ‹ŸæŒ‰é’®äº‹ä»¶');
            
            const mockResult = document.getElementById('mockResult');
            
            // æ¨¡æ‹Ÿåˆ·æ–°æŒ‰é’®
            document.getElementById('mockRefreshBtn').addEventListener('click', function() {
                mockResult.innerHTML = 'âœ… åˆ·æ–°æŒ‰é’®ç‚¹å‡»æˆåŠŸï¼';
                mockResult.className = 'result success';
                console.log('æ¨¡æ‹Ÿåˆ·æ–°æŒ‰é’®ç‚¹å‡»');
            });
            
            // æ¨¡æ‹Ÿåˆ›å»ºæŒ‰é’®
            document.getElementById('mockCreateBtn').addEventListener('click', function() {
                mockResult.innerHTML = 'âœ… åˆ›å»ºè·‘å›¢æŒ‰é’®ç‚¹å‡»æˆåŠŸï¼';
                mockResult.className = 'result success';
                console.log('æ¨¡æ‹Ÿåˆ›å»ºæŒ‰é’®ç‚¹å‡»');
            });
            
            // æ¨¡æ‹Ÿå¸®åŠ©æŒ‰é’®
            document.getElementById('mockHelpBtn').addEventListener('click', function() {
                mockResult.innerHTML = 'âœ… å¸®åŠ©æŒ‰é’®ç‚¹å‡»æˆåŠŸï¼';
                mockResult.className = 'result success';
                console.log('æ¨¡æ‹Ÿå¸®åŠ©æŒ‰é’®ç‚¹å‡»');
            });
            
            console.log('æ‰€æœ‰æ¨¡æ‹ŸæŒ‰é’®äº‹ä»¶ç»‘å®šå®Œæˆ');
        });

        // è‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•
        setTimeout(function() {
            console.log('è‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•');
            testBasicClick();
        }, 1000);
    </script>
</body>
</html>