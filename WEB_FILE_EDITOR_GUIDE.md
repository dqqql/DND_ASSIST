# Web文件编辑器使用指南

## 🎯 功能概述

现在你可以直接在Web界面中编辑所有类型的文件了！不再需要依赖外部编辑器。

## ✨ 新增功能

### 1. 通用文件编辑器
- 📝 支持所有文本文件的在线编辑
- 💾 实时保存功能
- 📊 文件统计信息（行数、字符数、字节数）
- 🎯 光标位置显示
- ⌨️ 快捷键支持（Ctrl+S保存）

### 2. 智能文件类型识别
- 🔍 自动识别文件类型
- 📄 文本文件：直接编辑内容
- 📊 JSON数据：格式化显示和编辑
- 🖼️ 图片文件：显示提示信息（无法编辑）

### 3. 安全保护机制
- ⚠️ 未保存更改提醒
- 🔒 页面关闭前确认
- 💾 自动保存状态显示

## 🚀 使用方法

### 步骤1：启动Web界面
```bash
python main_web.py
```

### 步骤2：创建或选择跑团
1. 在主界面点击"新建"创建跑团
2. 或选择现有跑团

### 步骤3：创建文件
1. 选择分类标签（人物卡、怪物卡、地图、剧情）
2. 点击"新建文件"按钮
3. 输入文件名并创建

### 步骤4：编辑文件
1. 在文件列表中选择要编辑的文件
2. 点击右侧的"编辑"按钮
3. 文件编辑器将在新标签页中打开

### 步骤5：编辑和保存
1. 在编辑器中修改文件内容
2. 使用Ctrl+S快捷键或点击"保存"按钮
3. 查看保存状态和文件统计信息

## 🎨 编辑器界面说明

### 顶部工具栏
- 📍 **文件信息**：显示当前跑团/分类/文件名
- ⬅️ **返回按钮**：返回主界面
- 💾 **保存按钮**：保存文件更改

### 编辑区域
- 📝 **主编辑器**：支持语法高亮的文本编辑器
- 📊 **统计信息**：实时显示行数、字符数、字节数
- 🎯 **光标位置**：显示当前光标的行列位置

### 状态栏
- 💾 **保存状态**：显示文件是否已保存
- 🕒 **最后修改时间**：显示文件最后保存时间
- 🔤 **编码格式**：显示文件编码（UTF-8）

## ⌨️ 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+S | 保存文件 |
| Tab | 插入4个空格 |
| Esc | 关闭对话框 |

## 🔧 支持的文件类型

### 人物卡 (characters)
- ✅ 文本文件 (.txt)
- ✅ JSON数据文件

### 怪物卡 (monsters)  
- ✅ 文本文件 (.txt)
- ✅ JSON数据文件

### 地图 (maps)
- ✅ 文本说明文件 (.txt)
- ⚠️ 图片文件（只读，显示提示）

### 剧情 (notes)
- ✅ 文本文件 (.txt)
- ✅ JSON剧情文件（可选择专用剧情编辑器）

## 🛡️ 安全特性

### 数据保护
- 🔄 实时检测文件更改
- ⚠️ 未保存更改时的离开提醒
- 💾 自动保存状态指示

### 错误处理
- 🚨 网络错误自动重试
- 📝 详细的错误信息提示
- 🔧 优雅的错误恢复机制

## 🎯 使用技巧

### 1. 高效编辑
- 使用Tab键快速缩进
- 利用Ctrl+S快速保存
- 观察状态栏了解文件状态

### 2. 文件管理
- 为不同类型的内容选择合适的分类
- 使用描述性的文件名
- 定期保存重要更改

### 3. 协作工作
- 文件保存后立即同步到本地
- 可以同时在多个标签页编辑不同文件
- 支持多人协作（文件级别）

## 🐛 故障排除

### 常见问题

**Q: 编辑器无法加载文件**
A: 检查跑团和文件是否存在，刷新页面重试

**Q: 保存失败**
A: 检查网络连接，确认文件权限，重试保存

**Q: 界面显示异常**
A: 清除浏览器缓存，刷新页面

**Q: 快捷键不工作**
A: 确保编辑器获得焦点，点击编辑区域后重试

### 技术支持
如果遇到问题，请：
1. 检查浏览器控制台的错误信息
2. 确认服务器正常运行
3. 尝试刷新页面或重启服务器

## 🔮 未来计划

- 🎨 语法高亮支持
- 🔍 文件内搜索和替换
- 📁 文件夹管理
- 🔄 版本历史记录
- 👥 实时协作编辑
- 🎯 代码自动补全

---

现在你可以完全在Web界面中管理和编辑所有跑团文件了！享受现代化的编辑体验吧！ 🎉